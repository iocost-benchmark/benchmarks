name: Run ci-scripts

on:
  push:
  pull_request:

jobs:
  run:
    name: Run ci-scripts
    runs-on: ubuntu-latest
    steps:
      - name: Checkout benchmarks repository
        uses: actions/checkout@v2

      - name: Download pre-build ci-scripts
        uses: dawidd6/action-download-artifact@v2
        with:
          workflow: build-ci-scripts.yml
          repo: 'iocost-benchmark/ci-scripts'

      - name: Set permissions on ci-scripts
        run: |
          chmod +x ci-scripts/ci-scripts/target/release/benchmark-database-ci
          chmod +x ci-scripts/resctl-demo/target/release/resctl-bench

      - name: Smoke-test benchmark-database-ci
        run: ci-scripts/ci-scripts/target/release/benchmark-database-ci --help
        
      - name: Smoke-test resctl-bench
        run: ci-scripts/resctl-demo/target/release/resctl-bench --help